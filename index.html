<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="animation"></div>
    <h1 id="wheater"></h1>


    <div id="count_down_container">
        <div id="outer_ring">
            <h1 id="time_left">20:20</h1>
            <img id="button" src="play.png">
        </div>
    </div>
</body>
<script>
window.addEventListener('load', async () => {
    const response = await fetch('https://wttr.in/Rotterdam?format=3')
    const weerTekst = await response.text();
    const wheater_element = document.getElementById("wheater")
    const animation_element = document.getElementById("animation")

    const match = weerTekst.match(/[\+\-]?\d+Â°C/);
    
    let temp = 0

    if (match) {
        let temp = match[0];
        temp = temp.replace ("+", "");
        console.log(temp);
    }

    if (temp > 10) {
        animation_element.classList.add("one")
    }
    
    if (temp > 15) {
        animation_element.classList.add("two")
    } 
    else if (temp > 21) {
        animation_element.classList.add("three")
    } 
    else {
        animation_element.classList.add("four")
    }

    wheater_element.innerHTML = weerTekst
});

let timer_stopped = false;
let timer_running = false;
let timer = null; 

const startTimer = () => {
    timer_stopped = false;

    const icon_element = document.getElementById("button");
    icon_element.src = "pauze.png";

    let time_left_element = document.getElementById("time_left");
    let time_left_text = time_left_element.innerHTML;
    const init_time_text = time_left_text;

    let time_left_string = time_left_text.split(':');
    let mn = parseInt(time_left_string[0]);
    let sec = parseInt(time_left_string[1]);

    timer = setInterval(() => {
        if (timer_stopped) {
            clearInterval(timer);
            timer = null;
            time_left_element.innerHTML = init_time_text;
            icon_element.src = "play.png";
            return;
        }

        if (sec === 0) {
            if (mn === 0) {
                clearInterval(timer);
                timer = null;
                console.log("Timer finished!");
                return;
            }
            mn = mn - 1;
            sec = 59;
        } else {
            sec = sec - 1;
        }

        time_left_element.innerHTML =
            `${mn}:${sec.toString().padStart(2, '0')}`;
    }, 1000);
};

const toggleTimer = () => {
    if (timer_running) {
        timer_running = false;
        stopTImer();
    } else {
        timer_running = true;
        startTimer();
    }
};

const stopTImer = () => {
    timer_stopped = true;
};

document.getElementById("button").addEventListener("click", toggleTimer);

</script>
</html>